!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){},function(e,t,r){"use strict";r.r(t);var n=e=>{const t=e,r=l[e];let n="horizontal";const a=Array(r).fill(null);return{id:t,length:r,hit:e=>a[e]="hit",getHits:()=>a,isSunk:()=>a.every(e=>"hit"===e),getDirection:()=>n,changeDirection:()=>{n="horizontal"===n?"vertical":"horizontal"}}};const a=["carrier","battleship","cruiser","submarine","destroyer"],l={carrier:5,battleship:4,cruiser:3,submarine:3,destroyer:2},o=(e=10)=>Math.floor(Math.random()*e),i=(e=10)=>[o(e),o(e)],s=e=>{const t={};return e.forEach(e=>t[e]=n(e)),t};var d=()=>{let e=Array(10).fill(null).map(()=>Array(10).fill(null));let t=[];const r=(e,t,r,n)=>{let a=t+r,l=e;return"vertical"===n&&(a=t,l=e+r),[l,a]},n=(n,a,o)=>{const i=n.getDirection(),s=l(n.length,i,a,o);if(s){for(let t=0;t<n.length;t++){const[l,s]=r(a,o,t,i);e[l][s]={ship:n,index:t}}return t.push(n),s}return s},l=(t,n,a,l)=>{const o=[];for(let i=0;i<t;i++){const[t,s]=r(a,l,i,n);if(!(t<10&&s<10))return!1;o.push(e[t][s])}return o.every(e=>null===e)},o=e=>{const[t,r]=i();Math.random()>.5&&e.changeDirection();n(e,t,r)||o(e)};return{getBoard:()=>e,placeShip:n,areAllShipsPlaced:()=>t.length===a.length,receiveAttack:(t,r)=>(null===e[t][r]?e[t][r]="miss":e[t][r].ship&&(e[t][r].ship.hit(e[t][r].index),e[t][r]="hit"),e[t][r]),areAllShipsSunk:()=>t.every(e=>e.isSunk()),autoPlaceFleet:e=>{for(const t in e)o(e[t])},reset:()=>{e=Array(10).fill(null).map(()=>Array(10).fill(null)),t=[]}}};var c=(e="human")=>{let t=s(a);const r=e=>{const[t,n]=i(),a=e.getBoard()[t][n];"miss"===a||"hit"===a?r(e):e.receiveAttack(t,n)};return{getType:()=>e,getFleet:()=>t,attack:(e,t,r)=>r.receiveAttack(e,t),autoAttack:r,resetFleet:()=>t=s(a)}};const u={p1Gameboard:document.querySelector(".p1-gameboard"),p2Gameboard:document.querySelector(".p2-gameboard"),p1Grid:document.querySelector(".p1-grid"),p2Grid:document.querySelector(".p2-grid"),infoContainer:document.querySelector(".info-container"),infoText:document.querySelector(".info-text"),autoPlaceBtn:document.querySelector(".fleet-autoplace"),playAgainBtn:document.querySelector(".play-again"),startBtn:document.querySelector(".start"),fleetContainer:document.querySelector(".fleet-container"),fleetDraggable:document.querySelector(".fleet-draggable"),fleetInfo:document.querySelector(".fleet-info")};var g=(()=>{const e=(e,t,r)=>`<div class="grid-cell cell-${e}-${t} ${r}" data-y='${e}' data-x='${t}'></div>`;return{renderGrid:(t,r,n)=>{(e=>{e.textContent=""})(t);const a=r.getBoard(),l=a.length;let o="";for(let t=0;t<l;t++)for(let r=0;r<l;r++){let l=a[t][r];null===l?l="":l.ship&&(l="human"===n?l.ship.id:""),o+=e(t,r,l)}t.insertAdjacentHTML("afterbegin",o)},renderFleet:e=>{for(const t in e){const r=document.createElement("div");r.classList.add("ship",e[t].id+"-container"),r.setAttribute("draggable",!0),r.dataset.ship=""+e[t].id;let n="";for(let r=0;r<e[t].length;r++)n+=`<div class=${e[t].id} data-index='${r}'></div>`;r.insertAdjacentHTML("afterbegin",n),u.fleetDraggable.prepend(r)}},autoPlace:()=>{u.startBtn.classList.add("show"),u.fleetInfo.classList.add("hide"),u.fleetInfo.classList.remove("show"),u.fleetDraggable.textContent=""},startGame:()=>{u.p1Gameboard.classList.toggle("grid-disabled"),u.p2Gameboard.classList.toggle("grid-disabled"),u.p2Gameboard.classList.toggle("hide"),u.p2Gameboard.classList.toggle("show"),u.startBtn.classList.remove("show"),u.autoPlaceBtn.classList.remove("show"),u.fleetContainer.classList.toggle("slide-out"),u.fleetContainer.classList.toggle("slide-in")},renderWinner:e=>{u.infoContainer.classList.toggle("show"),u.infoText.textContent=""+e.toUpperCase()},playAgain:()=>{u.infoContainer.classList.toggle("show"),u.p1Gameboard.classList.toggle("grid-disabled"),u.p2Gameboard.classList.toggle("grid-disabled"),u.p2Gameboard.classList.toggle("hide"),u.p2Gameboard.classList.toggle("show"),u.fleetInfo.classList.toggle("hide"),u.fleetInfo.classList.toggle("show"),u.autoPlaceBtn.classList.add("show"),u.fleetContainer.classList.toggle("slide-in"),u.fleetContainer.classList.toggle("slide-out")}}})();var p=(e,t)=>{let r,n;const a=e=>n=Number(e.target.dataset.index),l=e=>{r=e.target},o=a=>{const l=a.target,o=e.getFleet()[r.dataset.ship],i="horizontal"===o.getDirection(),s=Number(l.dataset.y)-(i?0:n),d=Number(l.dataset.x)-(i?n:0);t.placeShip(o,s,d)&&(g.renderGrid(u.p1Grid,t,e.getType()),p(),r.parentElement.removeChild(r),t.areAllShipsPlaced()&&(u.startBtn.classList.add("show"),u.fleetInfo.classList.add("hide"),u.fleetInfo.classList.remove("show")))},i=e=>e.preventDefault(),s=e=>e.preventDefault(),d=()=>{},c=()=>{},p=()=>{const e=document.querySelectorAll(".ship"),t=u.p1Grid.childNodes;for(const t of e)t.addEventListener("mousedown",a),t.addEventListener("dragstart",l),t.addEventListener("dragend",c);for(const e of t)e.addEventListener("dragover",i),e.addEventListener("dragenter",s),e.addEventListener("dragleave",d),e.addEventListener("drop",o)};return{addDragAndDropEvenListeners:p}};var f=e=>{const t=c("human");let r;r=c("singleplayer"===e?"computer":"human");const n=d(),a=d(),l=p(t,n),o=()=>{g.renderFleet(t.getFleet()),l.addDragAndDropEvenListeners(),document.querySelectorAll(".ship").forEach(e=>{e.addEventListener("dblclick",e=>{const r=e.target.parentElement;t.getFleet()[r.dataset.ship].changeDirection(),r.classList.toggle("vertical")})})},i=e=>{const l=e.target;if(l.classList.contains("grid-cell")){const e=l.dataset.y,o=l.dataset.x,d=a.getBoard()[e][o];if("miss"!==d&&"hit"!==d&&(t.attack(e,o,a),r.autoAttack(n),s()),n.areAllShipsSunk()||a.areAllShipsSunk()){let e="";n.areAllShipsSunk()?e="Computer wins!":a.areAllShipsSunk()&&(e="You win!"),u.p2Grid.removeEventListener("click",i),g.renderWinner(e)}}},s=()=>{g.renderGrid(u.p1Grid,n,t.getType()),g.renderGrid(u.p2Grid,a,r.getType())};return{renderGrids:s,renderFleet:o,autoPlace:()=>{n.reset(),n.autoPlaceFleet(t.getFleet()),s(),g.autoPlace()},startGame:()=>{"human"===r.getType&&u.p1Grid.addEventListener("click",i),u.p2Grid.addEventListener("click",i),"computer"===r.getType()&&a.autoPlaceFleet(r.getFleet()),g.startGame()},playAgain:()=>{t.resetFleet(),r.resetFleet(),n.reset(),a.reset(),s(),g.playAgain(),o()}}};r(0);let h=f("singleplayer");h.renderGrids(),h.renderFleet(),u.autoPlaceBtn.addEventListener("click",e=>{console.log("autoplaced player fleet"),h.autoPlace()}),u.startBtn.addEventListener("click",e=>{console.log("GAME START"),h.startGame()}),u.playAgainBtn.addEventListener("click",e=>{console.log("LETS PLAY AGAIN"),h.playAgain()})}]);